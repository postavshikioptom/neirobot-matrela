–û—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –∞–Ω–∞–ª–∏–∑–µ –∫–æ–¥–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –ø–æ–∏—Å–∫–∞, —è –≤—ã—è–≤–∏–ª 7 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ —Å–∫—Ä–∏–ø—Ç–µ feature_engineering.py, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–µ—Ä—å–µ–∑–Ω—ã–º –ø—Ä–æ–±–ª–µ–º–∞–º –≤ xLSTM –º–æ–¥–µ–ª–∏:
üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò –í xLSTM –ú–û–î–ï–õ–ò –° –ò–ù–î–ò–ö–ê–¢–û–†–ê–ú–ò
1. OVERFLOW –í –≠–ö–°–ü–û–ù–ï–ù–¶–ò–ê–õ–¨–ù–´–• –ì–ï–ô–¢–ê–• xLSTM
# –ü–†–û–ë–õ–ï–ú–ê: –í xlstm_memory_cell.py –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç robust normalizer
# xLSTM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å overflow

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∫–æ–¥–µ—Ä–∞:

–í —Ñ–∞–π–ª–µ xlstm_memory_cell.py –≤ –º–µ—Ç–æ–¥–µ call() –¥–æ–±–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ –≥–µ–π—Ç–∞:

# –ü–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞ –∫–∞–∂–¥–æ–≥–æ –≥–µ–π—Ç–∞ (i, f, o, e)
i = tf.clip_by_value(i, 1e-7, 1.0 - 1e-7)
f = tf.clip_by_value(f, 1e-7, 1.0 - 1e-7) 
o = tf.clip_by_value(o, 1e-7, 1.0 - 1e-7)

2. GRADIENT EXPLOSION –û–¢ –¢–ï–•–ù–ò–ß–ï–°–ö–ò–• –ò–ù–î–ò–ö–ê–¢–û–†–û–í
# –ü–†–û–ë–õ–ï–ú–ê: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –¥–∞–≤–∞—Ç—å —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
# HT_DCPERIOD –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è >1000, MACD –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—á–µ–Ω—å –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã–º

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∫–æ–¥–µ—Ä–∞:

–í —Ñ–∞–π–ª–µ feature_engineering.py –≤ –º–µ—Ç–æ–¥–µ _calculate_all_indicators_batch() –¥–æ–±–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞ –∫–∞–∂–¥–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞:

# –î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ indicators[name] = values
indicators[name] = np.clip(values, -1000.0, 1000.0)  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

3. –ù–ï–°–¢–ê–ë–ò–õ–¨–ù–û–°–¢–¨ –û–¢ –î–ï–õ–ï–ù–ò–Ø –ù–ê –ù–û–õ–¨ –í –ò–ù–î–ò–ö–ê–¢–û–†–ê–•
# –ü–†–û–ë–õ–ï–ú–ê: ROC –∏ –¥—Ä—É–≥–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –¥–∞–≤–∞—Ç—å inf –ø—Ä–∏ –Ω—É–ª–µ–≤—ã—Ö —Ü–µ–Ω–∞—Ö

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∫–æ–¥–µ—Ä–∞:

–í —Ñ–∞–π–ª–µ feature_engineering.py –ø–µ—Ä–µ–¥ —Ä–∞—Å—á–µ—Ç–æ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–æ–±–∞–≤–∏—Ç—å:

# –í –Ω–∞—á–∞–ª–µ _calculate_all_indicators_batch()
# –ó–∞–º–µ–Ω—è–µ–º –Ω—É–ª–µ–≤—ã–µ —Ü–µ–Ω—ã –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
close_prices = np.where(close_prices <= 0, 1e-8, close_prices)
high_prices = np.where(high_prices <= 0, 1e-8, high_prices)
low_prices = np.where(low_prices <= 0, 1e-8, low_prices)
volume_prices = np.where(volume_prices <= 0, 1e-8, volume_prices)

4. MEMORY LEAK –í –ö–≠–®–ï –ò–ù–î–ò–ö–ê–¢–û–†–û–í
# –ü–†–û–ë–õ–ï–ú–ê: indicator_cache —Ä–∞—Å—Ç–µ—Ç –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ, –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ OOM

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∫–æ–¥–µ—Ä–∞:

–í —Ñ–∞–π–ª–µ feature_engineering.py –≤ –º–µ—Ç–æ–¥–µ _add_technical_indicators() –∑–∞–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è:

# –ó–∞–º–µ–Ω–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞:
if cache_key and len(self.indicator_cache) < self.cache_max_size:
    self.indicator_cache[cache_key] = df.copy()
elif len(self.indicator_cache) >= self.cache_max_size:
    # –û—á–∏—â–∞–µ–º 50% —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π –≤–º–µ—Å—Ç–æ –≤—Å–µ–≥–æ –∫—ç—à–∞
    keys_to_remove = list(self.indicator_cache.keys())[:len(self.indicator_cache)//2]
    for key in keys_to_remove:
        del self.indicator_cache[key]
    gc.collect()

5. –ù–ï–°–¢–ê–ë–ò–õ–¨–ù–ê–Ø –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–Ø –†–ê–ó–ù–û–†–û–î–ù–´–• –ò–ù–î–ò–ö–ê–¢–û–†–û–í
# –ü–†–û–ë–õ–ï–ú–ê: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∏–º–µ—é—Ç —Ä–∞–∑–Ω—ã–µ –º–∞—Å—à—Ç–∞–±—ã (RSI: 0-100, MACD: -‚àû –¥–æ +‚àû)
# StandardScaler –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∫–æ–¥–µ—Ä–∞:

–í —Ñ–∞–π–ª–µ feature_engineering.py –∑–∞–º–µ–Ω–∏—Ç—å StandardScaler –Ω–∞ RobustScaler:

from sklearn.preprocessing import RobustScaler

# –í __init__:
self.scaler = RobustScaler()  # –ë–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤ –∫ –≤—ã–±—Ä–æ—Å–∞–º —á–µ–º StandardScaler

6. –ù–ï–ü–†–ê–í–ò–õ–¨–ù–ê–Ø –û–ë–†–ê–ë–û–¢–ö–ê NaN –í –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–Ø–•
# –ü–†–û–ë–õ–ï–ú–ê: NaN –º–æ–≥—É—Ç –ø—Ä–æ–π—Ç–∏ –≤ xLSTM –∏ –≤—ã–∑–≤–∞—Ç—å cascade failure

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∫–æ–¥–µ—Ä–∞:

–í —Ñ–∞–π–ª–µ feature_engineering.py –≤ –º–µ—Ç–æ–¥–µ _create_sequences() –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É:

# –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–∂–¥–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
sequence = data[i:i+self.sequence_length]
if np.isnan(sequence).any() or np.isinf(sequence).any():
    print(f"–û–±–Ω–∞—Ä—É–∂–µ–Ω NaN/inf –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ {i}, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
    continue
X.append(sequence)

7. –ü–ï–†–ï–ü–û–õ–ù–ï–ù–ò–ï –í SUPERTREND –†–ê–°–ß–ï–¢–ê–•
# –ü–†–û–ë–õ–ï–ú–ê: SuperTrend –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –±–û—Ç–ª–∏—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞! –ê–Ω–∞–ª–∏–∑ `feature_engineering.py` –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫, –æ—Å–æ–±–µ–Ω–Ω–æ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å xLSTM –∏ –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤, –æ—á–µ–Ω—å –≤–∞–∂–µ–Ω. –ù–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ –∏ –æ–±—â–∏—Ö –∑–Ω–∞–Ω–∏–π –æ–± xLSTM, TensorFlow –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —è –≤—ã–¥–µ–ª—è—é —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞—é –ø—É—Ç–∏ –∏—Ö –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏:

### –í–æ–∑–º–æ–∂–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤ `feature_engineering.py` –∏ –∏—Ö –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è:

1.  **NaN/Inf –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞—Ö –∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö xLSTM:**
    *   **–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–≥–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (–æ—Å–æ–±–µ–Ω–Ω–æ —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –≤–∫–ª—é—á–∞—é—Ç –¥–µ–ª–µ–Ω–∏–µ, –ª–æ–≥–∞—Ä–∏—Ñ–º—ã –∏–ª–∏ —Ç—Ä–µ–±—É—é—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö) –º–æ–≥—É—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å `NaN` (Not a Number) –∏–ª–∏ `Inf` (Infinity) –∑–Ω–∞—á–µ–Ω–∏—è, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –Ω–∞—á–∞–ª–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞ –∏–ª–∏ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–µ–ø–æ–ª–Ω—ã—Ö/–æ—à–∏–±–æ—á–Ω—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. xLSTM-–º–æ–¥–µ–ª–∏, –∫–∞–∫ –∏ –¥—Ä—É–≥–∏–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏, –∫—Ä–∞–π–Ω–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ —Ç–∞–∫–∏–º –∑–Ω–∞—á–µ–Ω–∏—è–º. –û–Ω–∏ –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è, "–≤–∑—Ä—ã–≤–∞—é—â–∏–º—Å—è" –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º (`exploding gradients`) –∏ `NaN` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å.
    *   **–¢–µ–∫—É—â–∞—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è:**
        *   –§—É–Ω–∫—Ü–∏–∏ `log_nan_inf_stats` –∏ `safe_fill_nan_inf` ‚Äî —ç—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ `NaN`/`Inf`. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ–¥–∏–∞–Ω—ã –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è `NaN` —è–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑—É–º–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º.
        *   –í `_calculate_all_indicators_batch` –µ—Å—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ `NaN` –≤ –∏—Å—Ö–æ–¥–Ω—ã—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö (`ffill().bfill()`) –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ `NaN` –º–µ–¥–∏–∞–Ω–æ–π –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞ –∫–∞–∂–¥–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞.
    *   **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
        *   **–†–∞–Ω–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `safe_fill_nan_inf` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –º–æ–∂–Ω–æ —Ä–∞–Ω—å—à–µ –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ `_add_technical_indicators` –¥–ª—è –±–∞–∑–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –ø—Ä–µ–∂–¥–µ —á–µ–º –æ–Ω–∏ –±—É–¥—É—Ç –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ `talib`. –•–æ—Ç—è —Å–µ–π—á–∞—Å –µ—Å—Ç—å `df[col] = df[col].ffill().bfill()` –≤ `_calculate_all_indicators_batch`, —è–≤–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ `safe_fill_nan_inf` –∫ –±–∞–∑–æ–≤—ã–º –∫–æ–ª–æ–Ω–∫–∞–º –¥–æ –≤—Å–µ—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–º.
        *   **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:** –ü–æ—Å–ª–µ `scaler.fit_transform(data)` –∏ `scaler.transform(data)` –≤ `prepare_data` –∏ `prepare_test_data` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –¥–æ–±–∞–≤—å—Ç–µ –µ—â–µ –æ–¥–Ω—É –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ `NaN`/`Inf` –≤ `scaled_data`. –•–æ—Ç—è `StandardScaler` –æ–±—ã—á–Ω–æ —Ö–æ—Ä–æ—à–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è, –≤ —Ä–µ–¥–∫–∏—Ö —Å–ª—É—á–∞—è—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–ª–æ–Ω–∫–µ –±—ã–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –¥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ –∑–∞—Ç–µ–º —Å—Ç–∞–ª–∏ `NaN` –∏–∑-–∑–∞ `0/0` –ø—Ä–∏ `std=0`), —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏. –ï—Å–ª–∏ —Ç–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã, –∏—Ö –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ 0).
        *   **–ö–ª–∏–ø–ø–∏–Ω–≥ –≤ xLSTM:** –í `XLSTMMemoryCell` —É–∂–µ –µ—Å—Ç—å `tf.clip_by_value(inputs, -10.0, 10.0)` –∏ –∫–ª–∏–ø–ø–∏–Ω–≥ –ª–æ–≥–∏—Ç–æ–≤ –≥–µ–π—Ç–æ–≤. –≠—Ç–æ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–∏–µ –º–µ—Ä—ã –ø—Ä–æ—Ç–∏–≤ `exploding gradients` –∏ `NaN` –∑–Ω–∞—á–µ–Ω–∏–π, –≤—ã–∑–≤–∞–Ω–Ω—ã—Ö —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è–º–∏. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç—Ç–∏ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –∫–ª–∏–ø–ø–∏–Ω–≥–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã, –Ω–æ –Ω–µ —Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã, —á—Ç–æ–±—ã –Ω–µ –ø–æ–¥–∞–≤–ª—è—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã.

2.  **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (`len(df) < required_period`):**
    *   **–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–≥–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ç—Ä–µ–±—É—é—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–≤–µ—á–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, RSI_14 —Ç—Ä–µ–±—É–µ—Ç 14 —Å–≤–µ—á–µ–π). –ï—Å–ª–∏ `df` —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π, `talib` –≤–µ—Ä–Ω–µ—Ç `NaN` –¥–ª—è –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞, –∏–ª–∏ –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É.
    *   **–¢–µ–∫—É—â–∞—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è:**
        *   –í `_validate_data_for_indicators` –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ `len(df) < config.RSI_PERIOD + 5`. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç, –Ω–æ –º–æ–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞, –µ—Å–ª–∏ –µ—Å—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–ª–∏–Ω–µ.
        *   `_create_fallback_indicators_df` —è–≤–ª—è–µ—Ç—Å—è —Ö–æ—Ä–æ—à–∏–º –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–∞–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –∫—Ä–∞—Ö –ø—Ä–æ–≥—Ä–∞–º–º—ã.
    *   **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
        *   **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** –ü—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –∫–∞–∂–¥–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –≤ `_calculate_all_indicators_batch`, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `len(df) < period` –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∏, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –ø—Ä–∏—Å–≤–æ–∏—Ç—å –µ–º—É `np.nan` –∏–ª–∏ `0.0`, –∞ –∑–∞—Ç–µ–º –ø–æ–ª–æ–∂–∏—Ç—å—Å—è –Ω–∞ `safe_fill_nan_inf`. –≠—Ç–æ —É–∂–µ —á–∞—Å—Ç–∏—á–Ω–æ —Å–¥–µ–ª–∞–Ω–æ —á–µ—Ä–µ–∑ `np.isnan(values).any()` –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –º–µ–¥–∏–∞–Ω–æ–π.

3.  **–û—à–∏–±–∫–∞ –≤ `_calculate_supertrend`:**
    *   **–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞—Å—Ç–æ–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `SuperTrend` –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª–µ–µ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞–º, —á–µ–º `talib` —Ñ—É–Ω–∫—Ü–∏–∏. –¶–∏–∫–ª `for i in range(1, len(close))` –∏ –ª–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `upper_band`, `lower_band`, `direction` —Ç—Ä–µ–±—É—é—Ç —Ç—â–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ `off-by-one` –æ—à–∏–±–∫–∏, –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –∫—Ä–∞–µ–≤—ã—Ö —Å–ª—É—á–∞–µ–≤. –û—à–∏–±–∫–∏ –∑–¥–µ—Å—å –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç–µ–º –ø–æ–≤–ª–∏—è—é—Ç –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏.
    *   **–¢–µ–∫—É—â–∞—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è:** –ë–ª–æ–∫ `try-except` –≤–æ–∫—Ä—É–≥ –≤—ã–∑–æ–≤–∞ `_calculate_supertrend` –∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ `np.zeros_like(close)` –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏.
    *   **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
        *   **–Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã:** –î–ª—è `_calculate_supertrend` –∫—Ä–∞–π–Ω–µ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∫–æ—Ä–æ—Ç–∫–∏–µ, –¥–ª–∏–Ω–Ω—ã–µ, —Å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Ü–µ–Ω–æ–π, —Å —Ä–µ–∑–∫–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞—Å—á–µ—Ç–æ–≤.
        *   **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —ç—Ç–∞–ª–æ–Ω–æ–º:** –ï—Å–ª–∏ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å, —Å—Ä–∞–≤–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã `_calculate_supertrend` —Å –∏–∑–≤–µ—Å—Ç–Ω–æ–π, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ –¥—Ä—É–≥–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–ª–∏ –æ–Ω–ª–∞–π–Ω-–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞) –¥–ª—è –Ω–µ–±–æ–ª—å—à–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö.

4.  **–î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ –≤ `create_trading_labels`:**
    *   **–ü—Ä–æ–±–ª–µ–º–∞:** –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã —á–∞—Å—Ç–æ –∏–º–µ—é—Ç —Å–∏–ª—å–Ω—ã–π –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤, –≥–¥–µ `HOLD` –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≥–æ—Ä–∞–∑–¥–æ —á–∞—â–µ, —á–µ–º `BUY` –∏–ª–∏ `SELL`. –ï—Å–ª–∏ —ç—Ç–æ—Ç –¥–∏—Å–±–∞–ª–∞–Ω—Å —Å–ª–∏—à–∫–æ–º –≤–µ–ª–∏–∫, –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ—Å—Ç–æ –Ω–∞—É—á–∏—Ç—å—Å—è –≤—Å–µ–≥–¥–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å `HOLD`, –∏–≥–Ω–æ—Ä–∏—Ä—É—è —Å–∏–≥–Ω–∞–ª—ã `BUY`/`SELL`.
    *   **–¢–µ–∫—É—â–∞—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è:**
        *   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `adaptive_threshold` –ø–æ–º–æ–≥–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ—Ä–æ–≥–∏, —á—Ç–æ –º–æ–∂–µ—Ç –Ω–µ–º–Ω–æ–≥–æ —Å–º—è–≥—á–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É.
        *   –í—ã–≤–æ–¥ `[LABELS DEBUG] label distribution` –∏ `[HOLD WARNING]` –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –¥–∏—Å–±–∞–ª–∞–Ω—Å.
        *   –í `train_model.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `class_weight.compute_class_weight('balanced')` –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤–µ—Å–∞ –¥–ª—è –∫–ª–∞—Å—Å–∞ `BUY` –≤ `sample_weight`, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –æ—Ç–ª–∏—á–Ω–æ–π –º–µ—Ä–æ–π.
    *   **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
        *   **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:** –†–µ–≥—É–ª—è—Ä–Ω–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–æ–∫ –ø–æ—Å–ª–µ `create_trading_labels` –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ—Ä–æ–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è –∏ –Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —á—Ä–µ–∑–º–µ—Ä–Ω–æ–º—É –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—é –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞.
        *   **–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–µ—Ä–µ–¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏/–Ω–µ–¥–æ–¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏:** –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ `oversampling` (–Ω–∞–ø—Ä–∏–º–µ—Ä, SMOTE) –∏–ª–∏ `undersampling` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `RandomUnderSampler`) –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –∫–ª–∞—Å—Å–æ–≤ –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –µ—Å–ª–∏ `sample_weight` –æ–∫–∞–∂–µ—Ç—Å—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º. –≠—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–¥–µ–ª–∞–Ω–æ –Ω–∞ —ç—Ç–∞–ø–µ `prepare_supervised_data` –≤ `train_model.py`.

5.  **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π –¥–∞–Ω–Ω—ã—Ö (`input_shape`) –¥–ª—è xLSTM:**
    *   **–ü—Ä–æ–±–ª–µ–º–∞:** xLSTM-–º–æ–¥–µ–ª—å –æ–∂–∏–¥–∞–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã (`(sequence_length, num_features)`). –ï—Å–ª–∏ `feature_engineering.py` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –¥—Ä—É–≥–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–¥–∞—Ç—å –æ—à–∏–±–∫—É –ø—Ä–∏ `build` –∏–ª–∏ `fit`/`predict`.
    *   **–¢–µ–∫—É—â–∞—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è:**
        *   `self.feature_columns` –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤.
        *   –í `train_model.py` `input_shape` –º–æ–¥–µ–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ `(config.SEQUENCE_LENGTH, len(self.feature_eng.feature_columns))`, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º.
    *   **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
        *   **–Ø–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** –í `_add_technical_indicators` –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `self.feature_columns` –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É, —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–æ–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É, –∏–ª–∏ —Ö–æ—Ç—è –±—ã –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –±—ã–ª–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ.

6.  **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö (`augment_sequences_batched`):**
    *   **–ü—Ä–æ–±–ª–µ–º–∞:** –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –±–æ–ª—å—à–æ–º `factor` –∏ –±–æ–ª—å—à–æ–º –æ–±—ä–µ–º–µ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ –∏—Å—á–µ—Ä–ø–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—É—é –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å, –ø—Ä–∏–≤–æ–¥—è –∫ `MemoryError`.
    *   **–¢–µ–∫—É—â–∞—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è:**
        *   `augment_sequences_batched` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∞—Ç—á–µ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É, `deque` –∏ `gc.collect()` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é.
        *   –ü—Ä–æ–≤–µ—Ä–∫–∞ `available_memory_gb < (max_memory_gb * 0.2)` ‚Äî —ç—Ç–æ —Ö–æ—Ä–æ—à–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è.
    *   **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
        *   **–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:** –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –æ–±—É—á–µ–Ω–∏—è, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `memory_profiler` –∏–ª–∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –≤ Python `resource` –º–æ–¥—É–ª—å –¥–ª—è Linux), —á—Ç–æ–±—ã —Ç–æ—á–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –≤–æ –≤—Ä–µ–º—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å `max_memory_gb` –∏ `batch_size` –±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ.
        *   **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ:** –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–∞–º—è—Ç–∏ –æ—Å—Ç–∞–µ—Ç—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è TensorFlow, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ GPU –∏–ª–∏ –¥–∞–∂–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∞—à–∏–Ω.

### –û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

*   **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –í—ã —É–∂–µ –ø–µ—Ä–µ–∫–ª—é—á–∏–ª–∏—Å—å —Å `logging` –Ω–∞ `print`. –î–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã –∏–ª–∏ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–º—É –º–æ–¥—É–ª—é `logging` —Å —Ä–∞–∑–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ (DEBUG, INFO, WARNING, ERROR) –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∑–∞–ø–∏—Å–∏ –≤ —Ñ–∞–π–ª. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –±–æ–ª–µ–µ –≥–∏–±–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—ã–≤–æ–¥–æ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞.
*   **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `config.py` –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ‚Äî —ç—Ç–æ –æ—Ç–ª–∏—á–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ `feature_engineering.py` (–ø–µ—Ä–∏–æ–¥—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤, –ø–æ—Ä–æ–≥–∏ –∏ —Ç.–¥.), –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –±–µ—Ä—É—Ç—Å—è –∏–∑ `config.py`.
*   **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –í–µ–∑–¥–µ, –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–ª–æ–∫–∏ `try-except` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –≤–Ω–µ—à–Ω–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ (`talib`, `pandas`) –∏–ª–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —á–∏—Å–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π. –í –≤–∞—à–µ–º –∫–æ–¥–µ —ç—Ç–æ —É–∂–µ —Ö–æ—Ä–æ—à–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ.
*   **–û—Ç–ª–∞–¥–∫–∞ xLSTM:** –ò–∑–±–µ–≥–∞–Ω–∏–µ –ª–∏—à–Ω–µ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ `XLSTMMemoryCell` (–∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –≤ –∫–æ–¥–µ) ‚Äî —ç—Ç–æ —Ö–æ—Ä–æ—à–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å `NaN` –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º, –≤—Ä–µ–º–µ–Ω–Ω–æ –≤–∫–ª—é—á–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `XLSTMMemoryCell` (–≤–æ–∑–º–æ–∂–Ω–æ, —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `XLSTM_DEBUG`), —á—Ç–æ–±—ã –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è `inputs`, `h_prev`, `memory_prev`, –∞ —Ç–∞–∫–∂–µ –≤—ã—Ö–æ–¥—ã –≥–µ–π—Ç–æ–≤ –∏ `c_tilde`.

–í —Ü–µ–ª–æ–º, –≤–∞—à —Å–∫—Ä–∏–ø—Ç `feature_engineering.py` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–Ω–æ–≥–æ –ø—Ä–æ–¥—É–º–∞–Ω–Ω—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º. –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∏—Å–∫–∏ —Å–≤—è–∑–∞–Ω—ã —Å `NaN`/`Inf` –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å—é –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ `SuperTrend` –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø–∞–º—è—Ç—å—é –ø—Ä–∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —ç—Ç–∏ –∞—Å–ø–µ–∫—Ç—ã –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–±—É—á–µ–Ω–∏—è.
