# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤ v4.0

## üîç –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —É–ª—É—á—à–µ–Ω–∏–π v3.0 –º–æ–¥–µ–ª—å –ø–µ—Ä–µ—à–ª–∞ –æ—Ç **95% BUY** –∫ **98% HOLD**, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ "–ø–µ—Ä–µ–∫—Ä—É—á–∏–≤–∞–Ω–∏–µ" –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É.

**–ò–∑ –ª–æ–≥–æ–≤:**
- –î–∞–Ω–Ω—ã–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã: SELL=28.31%, HOLD=33.86%, BUY=37.83%
- SMOTE –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª: "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏ (1.30 GB < 2.0 GB)"
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏: BUY ~95.8%, HOLD ~3.8%, SELL ~0.4%

## üîß –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. **–ü–µ—Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —Ü–µ–ª–µ–≤—ã—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–π –∫–ª–∞—Å—Å–æ–≤**
```python
# config.py
TARGET_CLASS_RATIOS = [0.3, 0.35, 0.35]  # –ë—ã–ª–æ: [0.25, 0.5, 0.25]
# –£–º–µ–Ω—å—à–∏–ª–∏ HOLD —Å 50% –¥–æ 35%, —É–≤–µ–ª–∏—á–∏–ª–∏ SELL/BUY
```

### 2. **–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ Focal Loss**
```python
# config.py
AFL_ALPHA = [1.1, 0.7, 1.0]   # –ë—ã–ª–æ: [1.0, 1.0, 0.8]
# –ü–æ–Ω–∏–∂–∞–µ–º –≤–ª–∏—è–Ω–∏–µ HOLD (0.7), –ø–æ–≤—ã—à–∞–µ–º SELL (1.1)

AFL_GAMMA = [2.0, 1.5, 2.5]   # –ë—ã–ª–æ: [2.0, 2.0, 3.0]
# –£–º–µ–Ω—å—à–∞–µ–º —Ñ–æ–∫—É—Å –Ω–∞ HOLD (1.5), —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –Ω–∞ BUY (2.5)

CLASS_SMOOTHING = [0.05, 0.08, 0.07]  # –ë—ã–ª–æ: [0.05, 0.05, 0.10]
# –ë–æ–ª—å—à–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è –¥–ª—è HOLD (0.08)
```

### 3. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≤–µ—Å–æ–≤**
```python
# config.py
DYNAMIC_WEIGHT_STEP = 0.08  # –ë—ã–ª–æ: 0.05
# –£–≤–µ–ª–∏—á–∏–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –Ω–∞ 60%

# models/xlstm_rl_model.py - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —à–∞–≥ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ
adaptive_step = self.step * (1.0 + 2.0 * max_deviation)  # –î–æ 3x –±–æ–ª—å—à–µ
```

### 4. **–£–ª—É—á—à–µ–Ω–Ω—ã–π Entropy Penalty**
```python
# config.py
ENTROPY_PENALTY_LAMBDA = 0.05  # –ë—ã–ª–æ: 0.0

# models/xlstm_rl_model.py - –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –ª—é–±–æ–º—É –∫–ª–∞—Å—Å—É —Å –≤—ã—Å–æ–∫–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é
max_pred = tf.reduce_max(y_pred, axis=-1)
high_confidence = tf.cast(tf.greater(max_pred, 0.8), tf.float32)
penalty = self.entropy_penalty_lambda * (1.0 - entropy) * high_confidence
```

### 5. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å SMOTE**
```python
# feature_engineering.py
if available_memory_gb < 1.0:  # –ë—ã–ª–æ: 2.0 GB
# –£–º–µ–Ω—å—à–∏–ª–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–∞–º—è—Ç–∏ –≤ 2 —Ä–∞–∑–∞

# config.py
CHUNKED_SMOTE_MAX_SYNTH_PER_CLASS = 10000  # –ë—ã–ª–æ: 15000
# –£–º–µ–Ω—å—à–∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±—Ä–∞–∑—Ü–æ–≤
```

### 6. **–ë–æ–ª–µ–µ —á–∞—Å—Ç—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
```python
# validation_metrics_callback.py
if (epoch + 1) % 1 == 0:  # –ë—ã–ª–æ: % 5 == 0
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–∂–¥—É—é —ç–ø–æ—Ö—É –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è
```

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### **–ú–µ—Ö–∞–Ω–∏–∑–º –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏:**
1. **–°—Ç–∞—Ä—Ç–æ–≤—ã–µ –≤–µ—Å–∞**: AFL_ALPHA=[1.1, 0.7, 1.0] —Å–Ω–∏–∂–∞—é—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç HOLD
2. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞**: –ü—Ä–∏ –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ >30% —à–∞–≥ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –¥–æ 3x
3. **Entropy penalty**: –®—Ç—Ä–∞—Ñ—É–µ—Ç –ª—é–±—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é >80%
4. **SMOTE**: –¢–µ–ø–µ—Ä—å –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ 1GB –≤–º–µ—Å—Ç–æ 2GB

### **–¶–µ–ª–µ–≤–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π:**
- **SELL**: 25-35% (–±—ã–ª–æ <1%)
- **HOLD**: 30-40% (–±—ã–ª–æ 98%)
- **BUY**: 30-40% (–±—ã–ª–æ 95%)

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∑–∞–ø—É—Å–∫—É

**–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω–µ—Å–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã:**
- ‚úÖ –ü–µ—Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã TARGET_CLASS_RATIOS
- ‚úÖ –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã AFL_ALPHA/GAMMA/SMOOTHING
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏
- ‚úÖ –£–ª—É—á—à–µ–Ω entropy penalty –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é –≤ SMOTE
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –±–æ–ª–µ–µ —á–∞—Å—Ç—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–ú–æ–¥–µ–ª—å –≥–æ—Ç–æ–≤–∞ –∫ –∑–∞–ø—É—Å–∫—É —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π –∫–ª–∞—Å—Å–æ–≤!**

---
**–°–æ–∑–¥–∞–Ω–æ**: $(Get-Date)  
**–°—Ç–∞—Ç—É—Å**: –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤