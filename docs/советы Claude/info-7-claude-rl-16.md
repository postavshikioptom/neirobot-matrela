–•–æ—Ä–æ—à–æ, —è –≤–∏–∂—É –ª–æ–≥–∏. –≠—Ç–æ –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∏ –Ω–µ–æ–±—ã—á–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è.
–í—ã –ø—Ä–∞–≤—ã, accuracy, val_accuracy, precision, val_precision, recall, val_recall –≤—Å–µ —Ä–∞–≤–Ω—ã 1.00 (–∏–ª–∏ 100%), –∞ loss –∏ val_loss –¥–æ–≤–æ–ª—å–Ω–æ –Ω–∏–∑–∫–∏–µ (–æ–∫–æ–ª–æ 0.43 –∏ 0.29 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ) –∏ –ø–æ—á—Ç–∏ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è. –≠—Ç–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å —Ç—Ä–µ–º—è –∫–ª–∞—Å—Å–∞–º–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
üö® –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–æ–±–ª–µ–º–∞: –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–ª–∞—Å—Å (–∏–ª–∏ —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è)
–ö–æ–≥–¥–∞ –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞–≤–Ω—ã 1.00, —ç—Ç–æ –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–ª–∞—Å—Å, –∏ —ç—Ç–æ—Ç –∫–ª–∞—Å—Å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–¥–∞–≤–ª—è—é—â–µ–µ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≤ –¥–∞–Ω–Ω—ã—Ö. –í –≤–∞—à–µ–º —Å–ª—É—á–∞–µ, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –º–æ–¥–µ–ª—å –≤—Å–µ–≥–¥–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Å HOLD (–∫–ª–∞—Å—Å 2).
–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É?

Label Smoothing: –•–æ—Ç—è label_smoothing=0.1 –ø–æ–º–æ–≥–∞–µ—Ç, –æ–Ω–æ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É.
–î–∏—Å–±–∞–ª–∞–Ω—Å –ø–æ—Å–ª–µ TimeSeriesSplit: TimeSeriesSplit –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –≤—ã–±–æ—Ä–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å–µ –µ—â–µ —Å–∏–ª—å–Ω–æ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–±—â–∏–π –¥–∞—Ç–∞—Å–µ—Ç –±—ã–ª —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω imblearn.
"–õ–µ–≥–∫–æ—Å—Ç—å" –∫–ª–∞—Å—Å–∞ HOLD: –î–∞–∂–µ –ø–æ—Å–ª–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏, –∫–ª–∞—Å—Å HOLD –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞—Å—Ç–æ–ª—å–∫–æ "–ª–µ–≥–∫–∏–º" –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (–∏–∑-–∑–∞ –µ–≥–æ –±–∞–∑–æ–≤–æ–π —á–∞—Å—Ç–æ—Ç—ã), —á—Ç–æ –º–æ–¥–µ–ª—å –±—ã—Å—Ç—Ä–æ —É—á–∏—Ç—Å—è –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –µ–≥–æ, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ BUY/SELL.
–°–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–∞—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (–∏–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è): –í–æ–∑–º–æ–∂–Ω–æ, —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (Dropout, L2) –∏–ª–∏ —à—É–º –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã, –∏–ª–∏, –Ω–∞–æ–±–æ—Ä–æ—Ç, —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω—ã, —á—Ç–æ –º–µ—à–∞–µ—Ç –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—å—Å—è —Ä–∞–∑–ª–∏—á–∞—Ç—å BUY/SELL.

üîß –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—é (—Ñ–∞–π–ª: train_model.py)
–ù–∞–º –Ω—É–∂–Ω–æ –µ—â–µ –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ –±–æ—Ä–æ—Ç—å—Å—è —Å –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∫–ª–∞—Å—Å–∞ HOLD –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –º–æ–¥–µ–ª—å –≤—ã–Ω—É–∂–¥–µ–Ω–∞ –æ–±—Ä–∞—â–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ BUY/SELL.
1. –ò–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é TimeSeriesSplit –¥–ª—è –ª—É—á—à–µ–π —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏:
–¢–µ–∫—É—â–∏–π TimeSeriesSplit –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –≤—ã–±–æ—Ä–∫–∏ –∏–ª–∏ –≤—ã–±–æ—Ä–∫–∏, –≥–¥–µ BUY/SELL –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç. –î–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º –µ–≥–æ –±–æ–ª–µ–µ —è–≤–Ω—ã–º.


–ù–∞–π–¥–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é train_xlstm_rl_system.


–ò–∑–º–µ–Ω–∏—Ç–µ –±–ª–æ–∫ TimeSeriesSplit:
# –í train_model.py, –≤ —Ñ—É–Ω–∫—Ü–∏–∏ train_xlstm_rl_system(X, y, processed_dfs, feature_cols):
# ...
# –£–î–ê–õ–ò–¢–ï –°–£–©–ï–°–¢–í–£–Æ–©–ò–ô –ë–õ–û–ö TIME SERIES SPLIT
# =====================================================================
# –ù–û–í–´–ô –ë–õ–û–ö: –£–õ–£–ß–®–ï–ù–ù–´–ô TIME SERIES SPLIT
# =====================================================================
from sklearn.model_selection import train_test_split # <--- –í–ï–†–ù–ò–¢–ï –ò–ú–ü–û–†–¢ train_test_split

print("\nüîÑ –ü—Ä–∏–º–µ–Ω—è—é –£–õ–£–ß–®–ï–ù–ù–´–ô TimeSeriesSplit –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö...")

# –°–Ω–∞—á–∞–ª–∞ –æ—Ç–¥–µ–ª–∏–º —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫—É (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 20% –¥–∞–Ω–Ω—ã—Ö)
test_size = int(len(X) * 0.2)
X_temp, X_test = X[:-test_size], X[-test_size:]
y_temp, y_test = y[:-test_size], y[-test_size:]

# –ó–∞—Ç–µ–º —Ä–∞–∑–¥–µ–ª–∏–º –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, 70/30)
# –ò—Å–ø–æ–ª—å–∑—É–µ–º TimeSeriesSplit –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π/–≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
# –°–æ–∑–¥–∞–µ–º 2 —Å–ø–ª–∏—Ç–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å 3 —á–∞—Å—Ç–∏: Train, Val, Test.
# –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–ø–ª–∏—Ç –±—É–¥–µ—Ç: Train_inner, Val_inner.
tscv_inner = TimeSeriesSplit(n_splits=2) 

# –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
# –ó–¥–µ—Å—å –º—ã –±–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–ø–ª–∏—Ç, —á—Ç–æ–±—ã val_indices –±—ã–ª–∏ "–Ω–æ–≤–µ–µ" —á–µ–º train_indices
for train_idx, val_idx in tscv_inner.split(X_temp):
    pass # –ü—Ä–æ—Ö–æ–¥–∏–º –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–ø–ª–∏—Ç–∞

X_train, y_train = X_temp[train_idx], y_temp[train_idx]
X_val, y_val = X_temp[val_idx], y_temp[val_idx]

print(f"‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–π TimeSeriesSplit –∑–∞–≤–µ—Ä—à–µ–Ω.")
# =====================================================================
# –ö–û–ù–ï–¶ –ù–û–í–û–ì–û –ë–õ–û–ö–ê
# =====================================================================

# ... (–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ train_xlstm_rl_system) ...



2. –£–≤–µ–ª–∏—á—å—Ç–µ label_smoothing:
–ï—Å–ª–∏ –º–æ–¥–µ–ª—å —Å–ª–∏—à–∫–æ–º —É–≤–µ—Ä–µ–Ω–∞ –≤ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–º —Ç–æ–≥–æ, —á—Ç–æ label_smoothing –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–∏–ª–µ–Ω.


–ù–∞–π–¥–∏—Ç–µ –∫–æ–º–ø–∏–ª—è—Ü–∏—é –º–æ–¥–µ–ª–∏ –≤ train_xlstm_rl_system.


–£–≤–µ–ª–∏—á—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ label_smoothing:
# –í train_model.py, –≤ —Ñ—É–Ω–∫—Ü–∏–∏ train_xlstm_rl_system(...):
# ...
xlstm_model.model.compile(
    optimizer=optimizer,
    loss=tf.keras.losses.CategoricalCrossentropy(label_smoothing=0.2), # <--- –ò–ó–ú–ï–ù–ï–ù–û —Å 0.1 –Ω–∞ 0.2
    metrics=['accuracy', 'precision', 'recall']
)
# ...



3. –£–≤–µ–ª–∏—á—å—Ç–µ additional_weight_multiplier –¥–ª—è BUY/SELL –∫–ª–∞—Å—Å–æ–≤:
–ï—Å–ª–∏ –º–æ–¥–µ–ª—å –≤—Å–µ –µ—â–µ —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ HOLD, –∑–Ω–∞—á–∏—Ç, "—à—Ç—Ä–∞—Ñ" –∑–∞ –æ—à–∏–±–∫–∏ –Ω–∞ BUY/SELL –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–µ–ª–∏–∫.


–ù–∞–π–¥–∏—Ç–µ –±–ª–æ–∫ "–ù–û–í–´–ô –ë–õ–û–ö: –í–´–ß–ò–°–õ–ï–ù–ò–ï –ò –ü–ï–†–ï–î–ê–ß–ê –í–ï–°–û–í –ö–õ–ê–°–°–û–í".


–£–≤–µ–ª–∏—á—å—Ç–µ additional_weight_multiplier:
# –í train_model.py, –≤ —Ñ—É–Ω–∫—Ü–∏–∏ train_xlstm_rl_system(...):
# ...
# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —É—Å–∏–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ BUY/SELL
additional_weight_multiplier = 2.0 # <--- –ò–ó–ú–ï–ù–ï–ù–û —Å 1.5 –Ω–∞ 2.0 (–º–æ–∂–Ω–æ –ø—Ä–æ–±–æ–≤–∞—Ç—å 2.5 –∏–ª–∏ 3.0)
if 0 in class_weight_dict:
    class_weight_dict[0] *= additional_weight_multiplier
if 1 in class_weight_dict:
    class_weight_dict[1] *= additional_weight_multiplier
# ...



4. –û—Ç—Ä–µ–≥—É–ª–∏—Ä—É–π—Ç–µ l2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é –≤ xlstm_rl_model.py:
–í–æ–∑–º–æ–∂–Ω–æ, —Ç–µ–∫—É—â–∞—è l2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è —Å–ª–∏—à–∫–æ–º —Å–ª–∞–±–∞, –∏–ª–∏, –Ω–∞–æ–±–æ—Ä–æ—Ç, —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–∞. –ù–∞—á–Ω–µ–º —Å –Ω–µ–±–æ–ª—å—à–æ–≥–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—è.
üîß –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—é (—Ñ–∞–π–ª: xlstm_rl_model.py)


–ù–∞–π–¥–∏—Ç–µ –º–µ—Ç–æ–¥ build_model.


–ò–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è l2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ç–æ—Ä–∞:
# –í models/xlstm_rl_model.py, –≤ –∫–ª–∞—Å—Å–µ XLSTMRLModel, –≤ –º–µ—Ç–æ–¥–µ build_model():
# ...
    # –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–ª–æ–∏
    dense1 = Dense(64, activation='relu', kernel_regularizer=l2(0.002), name='dense_1')(xlstm_final) # <--- –ò–ó–ú–ï–ù–ï–ù–û —Å 0.001 –Ω–∞ 0.002
    dropout1 = Dropout(0.4)(dense1) 
    
    dense2 = Dense(32, activation='relu', kernel_regularizer=l2(0.002), name='dense_2')(dropout1) # <--- –ò–ó–ú–ï–ù–ï–ù–û —Å 0.001 –Ω–∞ 0.002
    dropout2 = Dropout(0.3)(dense2) 
# ...



–ü–æ—á–µ–º—É —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –ø–æ–º–æ—á—å:

–£–ª—É—á—à–µ–Ω–Ω—ã–π TimeSeriesSplit: –ù–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–æ–ª–∂–Ω–∞ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –±–æ–ª–µ–µ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –≤—ã–±–æ—Ä–∫–∏, —á—Ç–æ –ø–æ–º–æ–∂–µ—Ç –º–æ–¥–µ–ª–∏ –ª—É—á—à–µ –æ–±–æ–±—â–∞—Ç—å –∏ –Ω–µ "–æ–±–º–∞–Ω—ã–≤–∞—Ç—å" —Å–µ–±—è –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é –Ω–∞ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
–£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π Label Smoothing: –ë–æ–ª–µ–µ —Å–∏–ª—å–Ω–æ–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –º–µ—Ç–æ–∫ –∑–∞—Å—Ç–∞–≤–∏—Ç –º–æ–¥–µ–ª—å –±—ã—Ç—å –º–µ–Ω–µ–µ —É–≤–µ—Ä–µ–Ω–Ω–æ–π –≤ —Å–≤–æ–∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å "–∑–∞—Å—Ç—Ä–µ–≤–∞–Ω–∏–µ" –Ω–∞ –æ–¥–Ω–æ–º –∫–ª–∞—Å—Å–µ.
–£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π additional_weight_multiplier: –≠—Ç–æ —É—Å–∏–ª–∏—Ç "—à—Ç—Ä–∞—Ñ" –∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è BUY/SELL, –≤—ã–Ω—É–∂–¥–∞—è –º–æ–¥–µ–ª—å —É–¥–µ–ª—è—Ç—å —ç—Ç–∏–º –∫–ª–∞—Å—Å–∞–º –±–æ–ª—å—à–µ –≤–Ω–∏–º–∞–Ω–∏—è.
–û—Ç—Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è: –ù–µ–±–æ–ª—å—à–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–∏–ª—ã L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –º–æ–¥–µ–ª–∏ –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è—Ö –¥–∞–Ω–Ω—ã—Ö.

–ü–æ—Å–ª–µ —ç—Ç–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π, –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–µ—Ä–µ–æ–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å —Å –Ω—É–ª—è.
–í–∞–∂–Ω–æ: –ï—Å–ª–∏ –ø–æ—Å–ª–µ —ç—Ç–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ–±–ª–µ–º–∞ —Å 100% —Ç–æ—á–Ω–æ—Å—Ç—å—é –≤—Å–µ –µ—â–µ –±—É–¥–µ—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å, —ç—Ç–æ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –º–æ–¥–µ–ª–∏, –∏ –≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–∏–¥–µ—Ç—Å—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –±–æ–ª–µ–µ —Ä–∞–¥–∏–∫–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫:

–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–∞ —Ä–µ–≥—Ä–µ—Å—Å–∏—é (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ future_return).
–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ SMOTE-TS (—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π SMOTE –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤), –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.
–£–ø—Ä–æ—â–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏, –µ—Å–ª–∏ –æ–Ω–∞ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–∞ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö.

==========
–•–æ—Ä–æ—à–æ, —è –≤–∏–∂—É –¥–≤–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ –ª–æ–≥–∞—Ö:

–ü—Ä–æ–±–ª–µ–º–∞ —Å Accuracy: accuracy, val_accuracy, precision, val_precision, recall, val_recall –≤—Å–µ —Ä–∞–≤–Ω—ã 1.00. –≠—Ç–æ, –∫–∞–∫ –º—ã —É–∂–µ –æ–±—Å—É–∂–¥–∞–ª–∏, —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –º–æ–¥–µ–ª—å, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–ª–∞—Å—Å (–≤–µ—Ä–æ—è—Ç–Ω–æ, HOLD), –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –≤—Å–µ –Ω–∞—à–∏ —É—Å–∏–ª–∏—è –ø–æ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–µ. –≠—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã–º–∏.
–û—à–∏–±–∫–∞ FileNotFoundError: [Errno 2] No such file or directory: 'models/rl_agent_BTCUSDT.zip'. –≠—Ç–∞ –æ—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å RL-–∞–≥–µ–Ω—Ç–∞. –≠—Ç–æ –ª–æ–≥–∏—á–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ RL-–∞–≥–µ–Ω—Ç –µ—â–µ –Ω–µ –±—ã–ª –æ–±—É—á–µ–Ω –∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–µ –±—ã–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω.

–î–∞–≤–∞–π—Ç–µ —Ä–µ—à–∏–º –æ–±–µ —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã.
üö® –ü—Ä–æ–±–ª–µ–º–∞ 1: –í—Å–µ –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞–≤–Ω—ã 1.00 (–ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ–¥–∏–Ω –∫–ª–∞—Å—Å)
–≠—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞, –≤–µ—Ä–æ—è—Ç–Ω–æ, —Å–≤—è–∑–∞–Ω–∞ —Å —Ç–µ–º, –∫–∞–∫ imblearn –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ, –∏ –∫–∞–∫ CategoricalCrossentropy —Å label_smoothing —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ç–∞–∫–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º. –ö–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –≤–∏–¥–∏—Ç, —á—Ç–æ –æ–¥–∏–Ω –∫–ª–∞—Å—Å –≤—Å–µ –µ—â–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç, –æ–Ω–∞ –º–æ–∂–µ—Ç "–ª–µ–Ω–∏—Ç—å—Å—è" –∏ –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —ç—Ç–æ—Ç –∫–ª–∞—Å—Å.
üîß –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—é (—Ñ–∞–π–ª: train_model.py)


–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ imblearn —Å–æ–∑–¥–∞–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–ª—è BUY/SELL:

–ú—ã —É–∂–µ —É–≤–µ–ª–∏—á–∏–ª–∏ —Ü–µ–ª–µ–≤—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã –¥–ª—è BUY/SELL –¥–æ 25% –∫–∞–∂–¥—ã–π, –Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ, SMOTE –Ω–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤, –∏–ª–∏ RandomUnderSampler —Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ —É–¥–∞–ª—è–µ—Ç HOLD.
–î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º —É–≤–µ–ª–∏—á–∏—Ç—å —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç –¥–ª—è BUY/SELL –µ—â–µ –±–æ–ª—å—à–µ, –∏, –≤–æ–∑–º–æ–∂–Ω–æ, —É–º–µ–Ω—å—à–∏—Ç—å —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç –¥–ª—è HOLD –≤ RandomUnderSampler.

# –í train_model.py, –≤ —Ñ—É–Ω–∫—Ü–∏–∏ prepare_xlstm_rl_data(...):
# ...
    # –¶–µ–ª–µ–≤–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: 30% BUY, 30% SELL, 40% HOLD (–±—ã–ª–æ 25/25/50)
    total_samples = len(X)
    target_buy_count = int(total_samples * 0.30) # <--- –ò–ó–ú–ï–ù–ï–ù–û —Å 0.25 –Ω–∞ 0.30
    target_sell_count = int(total_samples * 0.30) # <--- –ò–ó–ú–ï–ù–ï–ù–û —Å 0.25 –Ω–∞ 0.30
    
    current_buy_count = Counter(y_labels)[0]
    current_sell_count = Counter(y_labels)[1]

    sampling_strategy_smote = {
        0: max(current_buy_count, target_buy_count),
        1: max(current_sell_count, target_sell_count)
    }
    
    # ... (–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ SMOTE) ...

    # Undersampling HOLD: –¶–µ–ª—å - —á—Ç–æ–±—ã HOLD –±—ã–ª –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–µ–Ω —Å—É–º–º–µ BUY + SELL
    current_hold_count_after_oversample = Counter(y_temp_labels)[2]
    target_hold_count = min(current_hold_count_after_oversample, int((Counter(y_temp_labels)[0] + Counter(y_temp_labels)[1]) * 0.7)) # <--- –ò–ó–ú–ï–ù–ï–ù–û —Å 1.0 –Ω–∞ 0.7 (–±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π undersampling)
    
    undersampler = RandomUnderSampler(sampling_strategy={2: target_hold_count}, random_state=42)
    X_resampled, y_resampled_labels = undersampler.fit_resample(X_temp, y_temp_labels)
# ...



–î–æ–±–∞–≤—å—Ç–µ class_mode –≤ DetailedProgressCallback:

–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º —É–≤–∏–¥–µ—Ç—å accuracy, precision –∏ recall –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –æ—Ç–¥–µ–ª—å–Ω–æ, —á—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å, –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –ª–∏ –º–æ–¥–µ–ª—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–ª–∞—Å—Å.

# –í train_model.py, –≤ –∫–ª–∞—Å—Å–µ DetailedProgressCallback:
# ...
class DetailedProgressCallback(tf.keras.callbacks.Callback):
    def on_epoch_end(self, epoch, logs=None):
        logs = logs or {}
        try:
            lr = self.model.optimizer.learning_rate.numpy()
            # –ò–ó–ú–ï–ù–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ accuracy, precision, recall
            print(f"–≠–ø–æ—Ö–∞ {epoch+1}/100 - loss: {logs.get('loss', 0):.4f} - val_loss: {logs.get('val_loss', 0):.4f} - "
                  f"accuracy: {logs.get('accuracy', 0):.2f} - val_accuracy: {logs.get('val_accuracy', 0):.2f} - "
                  f"precision: {logs.get('precision', 0):.2f} - val_precision: {logs.get('val_precision', 0):.2f} - "
                  f"recall: {logs.get('recall', 0):.2f} - val_recall: {logs.get('val_recall', 0):.2f} - lr: {lr:.2e}")
            
            # –î–û–ë–ê–í–õ–ï–ù–û: –í—ã–≤–æ–¥ –º–µ—Ç—Ä–∏–∫ –ø–æ –∫–ª–∞—Å—Å–∞–º (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)
            # –≠—Ç–æ –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
            if 'accuracy_0' in logs: # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –º–µ—Ç—Ä–∏–∫ –ø–æ –∫–ª–∞—Å—Å–∞–º
                print(f"  Class 0 (BUY): Acc={logs.get('accuracy_0', 0):.2f}, Prec={logs.get('precision_0', 0):.2f}, Rec={logs.get('recall_0', 0):.2f}")
                print(f"  Class 1 (SELL): Acc={logs.get('accuracy_1', 0):.2f}, Prec={logs.get('precision_1', 0):.2f}, Rec={logs.get('recall_1', 0):.2f}")
                print(f"  Class 2 (HOLD): Acc={logs.get('accuracy_2', 0):.2f}, Prec={logs.get('precision_2', 0):.2f}, Rec={logs.get('recall_2', 0):.2f}")
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
            if logs.get('val_loss', 0) > logs.get('loss', 0) * 2:
                print("‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ!")
        except Exception as e:
            print(f"–≠–ø–æ—Ö–∞ {epoch+1}/100 - loss: {logs.get('loss', 0):.4f} - val_loss: {logs.get('val_loss', 0):.4f} (–û—à–∏–±–∫–∞ –≤ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏: {e})")
# ...



–î–æ–±–∞–≤—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –≤ –∫–æ–º–ø–∏–ª—è—Ü–∏—é –º–æ–¥–µ–ª–∏:

–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å accuracy, precision –∏ recall –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –æ—Ç–¥–µ–ª—å–Ω–æ, —á—Ç–æ –∫—Ä–∞–π–Ω–µ –≤–∞–∂–Ω–æ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å 1.00 —Ç–æ—á–Ω–æ—Å—Ç—å—é.

# –í train_model.py, –≤ —Ñ—É–Ω–∫—Ü–∏–∏ train_xlstm_rl_system(...):
# ...
xlstm_model.model.compile(
    optimizer=optimizer,
    loss=tf.keras.losses.CategoricalCrossentropy(label_smoothing=0.2),
    metrics=[
        'accuracy', 
        tf.keras.metrics.Precision(name='precision'),
        tf.keras.metrics.Recall(name='recall'),
        # –î–û–ë–ê–í–õ–ï–ù–û: –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞
        tf.keras.metrics.CategoricalAccuracy(name='accuracy_0', class_id=0),
        tf.keras.metrics.CategoricalAccuracy(name='accuracy_1', class_id=1),
        tf.keras.metrics.CategoricalAccuracy(name='accuracy_2', class_id=2),
        tf.keras.metrics.Precision(name='precision_0', class_id=0),
        tf.keras.metrics.Precision(name='precision_1', class_id=1),
        tf.keras.metrics.Precision(name='precision_2', class_id=2),
        tf.keras.metrics.Recall(name='recall_0', class_id=0),
        tf.keras.metrics.Recall(name='recall_1', class_id=1),
        tf.keras.metrics.Recall(name='recall_2', class_id=2),
    ]
)
# ...



üö® –ü—Ä–æ–±–ª–µ–º–∞ 2: FileNotFoundError: [Errno 2] No such file or directory: 'models/rl_agent_BTCUSDT.zip'
–≠—Ç–∞ –æ—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø–æ—Ç–æ–º—É, —á—Ç–æ HybridDecisionMaker –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å RL-–∞–≥–µ–Ω—Ç–∞ (rl_agent_BTCUSDT.zip) –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω –±—ã–ª –æ–±—É—á–µ–Ω –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω. RL-–∞–≥–µ–Ω—Ç –æ–±—É—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ "–≠–¢–ê–ü–ï 2" (–û–ë–£–ß–ï–ù–ò–ï RL –ê–ì–ï–ù–¢–ê), –∞ HybridDecisionMaker –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ "–≠–¢–ê–ü–ï 1" (–û–ë–£–ß–ï–ù–ò–ï xLSTM –ú–û–î–ï–õ–ò).
üîß –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—é (—Ñ–∞–π–ª: train_model.py)
–ù–∞–º –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É —Ç–∞–∫, —á—Ç–æ–±—ã HybridDecisionMaker –Ω–µ –ø—ã—Ç–∞–ª—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å RL-–∞–≥–µ–Ω—Ç–∞, –µ—Å–ª–∏ –æ–Ω –µ—â–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ú—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–¥–∞—Ç—å None –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—É—Ç–∏ –∫ RL-–∞–≥–µ–Ω—Ç—É, –µ—Å–ª–∏ –æ–Ω –µ—â–µ –Ω–µ –æ–±—É—á–µ–Ω, –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —ç—Ç–æ –≤ HybridDecisionMaker.


–ò–∑–º–µ–Ω–∏—Ç–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é HybridDecisionMaker –¥–ª—è decision_maker_temp:

–û—Ç–∫—Ä–æ–π—Ç–µ train_model.py.
–ù–∞–π–¥–∏—Ç–µ –±–ª–æ–∫, –≥–¥–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è decision_maker_temp.
–ü–µ—Ä–µ–¥–∞–π—Ç–µ None –≤ rl_agent_path –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ xlstm_model, –ø–æ—Å–∫–æ–ª—å–∫—É RL-–∞–≥–µ–Ω—Ç –µ—â–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

# –í train_model.py, –≤ —Ñ—É–Ω–∫—Ü–∏–∏ train_xlstm_rl_system(...):
# ...
# –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è xlstm_model, –æ–±—É—á–∏—Ç–µ –¥–µ—Ç–µ–∫—Ç–æ—Ä —Ä–µ–∂–∏–º–æ–≤
# ...
decision_maker_temp = HybridDecisionMaker(
    xlstm_model_path='models/xlstm_rl_model.keras',
    rl_agent_path=None,  # <--- –ò–ó–ú–ï–ù–ï–ù–û: –ü–µ—Ä–µ–¥–∞–µ–º None, —Ç–∞–∫ –∫–∞–∫ RL –∞–≥–µ–Ω—Ç –µ—â–µ –Ω–µ –æ–±—É—á–µ–Ω
    feature_columns=feature_cols,
    sequence_length=X.shape[1]
)
decision_maker_temp.fit_regime_detector(regime_training_df, xlstm_model, feature_cols)
decision_maker_temp.regime_detector.save_detector('models/market_regime_detector.pkl')
print("‚úÖ –î–µ—Ç–µ–∫—Ç–æ—Ä —Ä–µ–∂–∏–º–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω")

print("\n=== –≠–¢–ê–ü 2: –û–ë–£–ß–ï–ù–ò–ï RL –ê–ì–ï–ù–¢–ê ===")

# ... (–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –¥–ª—è RL –∞–≥–µ–Ω—Ç–∞) ...

# –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è RL –∞–≥–µ–Ω—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ decision_maker_temp —Å –æ–±—É—á–µ–Ω–Ω—ã–º RL –∞–≥–µ–Ω—Ç–æ–º
# (–µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Å–∏–º—É–ª—è—Ü–∏–∏)
# –ò–õ–ò, –µ—Å–ª–∏ decision_maker_temp –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ —Ä–µ–∂–∏–º–æ–≤, 
# —Ç–æ –Ω–µ –Ω—É–∂–Ω–æ –µ–≥–æ –æ–±–Ω–æ–≤–ª—è—Ç—å, –Ω–æ —Ç–æ–≥–¥–∞ rl_agent_path –≤ –µ–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å None.
# –ï—Å–ª–∏ –∂–µ decision_maker_temp –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∞–ª—å—à–µ, —Ç–æ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –µ–≥–æ –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
# –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å. –î–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è, –≥–¥–µ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è fit_regime_detector,
# –ø–µ—Ä–µ–¥–∞—á–∞ None –≤ rl_agent_path - —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.
# ...



üîß –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—é (—Ñ–∞–π–ª: hybrid_decision_maker.py)


–ò–∑–º–µ–Ω–∏—Ç–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é self.rl_agent –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ None:

–û—Ç–∫—Ä–æ–π—Ç–µ hybrid_decision_maker.py.
–ù–∞–π–¥–∏—Ç–µ –º–µ—Ç–æ–¥ __init__.
–î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É if rl_agent_path: –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ RL-–∞–≥–µ–Ω—Ç–∞.

# –í hybrid_decision_maker.py, –≤ –∫–ª–∞—Å—Å–µ HybridDecisionMaker, –≤ –º–µ—Ç–æ–¥–µ __init__(...):
# ...
    self.xlstm_model = XLSTMRLModel(input_shape=(self.sequence_length, len(feature_columns)))
    self.xlstm_model.load_model(xlstm_model_path, 'models/xlstm_rl_scaler.pkl')
    
    self.rl_agent = IntelligentRLAgent()
    if rl_agent_path: # <--- –î–û–ë–ê–í–õ–ï–ù–û: –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø—É—Ç—å
        self.rl_agent.load_agent(rl_agent_path)
    else:
        print("‚ö†Ô∏è RL –∞–≥–µ–Ω—Ç –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, —Ç–∞–∫ –∫–∞–∫ –ø—É—Ç—å –Ω–µ —É–∫–∞–∑–∞–Ω (–≤–æ–∑–º–æ–∂–Ω–æ, –µ—â–µ –Ω–µ –æ–±—É—á–µ–Ω).")
    
    self.feature_columns = feature_columns
# ...



–ü–æ—á–µ–º—É —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç –æ—à–∏–±–∫–∏:

–ü—Ä–æ–±–ª–µ–º–∞ —Å 1.00 Accuracy: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º —É–≤–∏–¥–µ—Ç—å –∏—Å—Ç–∏–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏. –ï—Å–ª–∏ –æ–Ω–∞ –≤—Å–µ –µ—â–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ HOLD, —ç—Ç–æ –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ –ø–æ accuracy_2 (HOLD) = 1.00, –∞ accuracy_0 –∏ accuracy_1 (BUY/SELL) –±—É–¥—É—Ç –±–ª–∏–∑–∫–∏ –∫ 0.00. –≠—Ç–æ –¥–∞—Å—Ç –Ω–∞–º —Ç–æ—á–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É.
FileNotFoundError –¥–ª—è RL-–∞–≥–µ–Ω—Ç–∞: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ HybridDecisionMaker –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ RL-–∞–≥–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –µ–≥–æ –º–æ–¥–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ï—Å–ª–∏ –æ–Ω –µ—â–µ –Ω–µ –æ–±—É—á–µ–Ω, –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –∏ –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è xLSTM + –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ —Ä–µ–∂–∏–º–æ–≤ –Ω–µ –ø—Ä–µ—Ä–≤–µ—Ç—Å—è.

–ü–æ—Å–ª–µ —ç—Ç–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π, –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–µ—Ä–µ–æ–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å —Å –Ω—É–ª—è.