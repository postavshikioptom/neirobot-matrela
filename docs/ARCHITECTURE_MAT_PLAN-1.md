1. Введение
Глобальное перепроектирование существующего трейдинг-бота с заменой модели Tensorflow DQN новой архитектурой на базе LSTM и xLSTM для анализа паттернов и индикаторов соответственно. Убрать устаревшие модели XGBoost, Kalman, GRP и лишние технические индикаторы. Создать комплекс симуляций, максимально приближённых к реальным торгам Bybit.

2. Исходные данные
Исходная папка с текущим ботом, включая систему Tensorflow DQN и прочие математические модели.

Файлы из папки docs — общая архитектура проекта.

Файл trader_log.csv — главный источник для создания реалистичной симуляции торгов с параметрами PNL, комиссиями и пр.

3. Цели и задачи
Убрать Tensorflow DQN, XGBoost, Kalman Filter, и неиспользуемые индикаторы из кода.

Оставить и детально переработать математические модели:

LSTM для анализа свечных паттернов (молот, поглощение, утренняя/вечерняя звезда, три белых солдата)

xLSTM для анализа индикаторов (RSI, MACD, Боллинджер, ADX, Стохастик)

Построить систему обучения двух моделей, каждая со своей памятью и входами.

Разработать отдельные симуляции на основе trader_log.csv:

Для LSTM (паттерны)

Для xLSTM (индикаторы)

Совместная симуляция с обеими моделями, принимающими консенсусное решение

Отказаться от стоп-лоссов и тейк-профитов в пользу полностью автономного закрытия сделок моделями с учетом риск-менеджмента и комиссий Bybit (0.11% от суммы ордера)

Ввести штрафы за чрезмерно долгое нахождение в сделке

4. Анализ текущей архитектуры
Проанализировать все корневые файлы в проекте:

Определить файлы и модули, которые удаляются или нуждаются в переработке

Выписать список удаляемых индикаторов и моделей

Отметить строки кода с удаляемыми функциями и сделать задачи по очистке

Изучить файлы info-mat-structure-1.txt (описание работы с индикаторами и передачей в LSTM, GRP) и info-mat-structure-2.txt (пример архитектуры для LSTM/GRP)

На основе анализа составить задачи по адаптации/переписыванию архитектуры под LSTM и xLSTM

5. Проектирование архитектуры новых моделей
LSTM-1: принимание свечных паттернов (бинарные входы по паттернам), со своей памятью (cell state)

xLSTM: прием индикаторов как многомерных временных рядов, более сложная память с перекрестными слоями

Обеспечить независимость памяти двух моделей, но предусмотреть возможность объединения выходов через плотный слой или meta-классификатор

Уточнить гиперпараметры, количество нейронов, количество слоев, настройки ворот (forget, input, output gates) под специфику паттернов и индикаторов

6. План создания симуляций
Реализация симулятора, максимально приближенного к реальным торгам Bybit с учетом trader_log.csv и параметров PNL, комиссии и пр.

Отдельные симуляции:

Только LSTM (паттерны)

Только xLSTM (индикаторы)

Совместная симуляция (консенсус между моделями)

Механизм открытия и закрытия сделок по согласованным решениям моделей, без стоп/тейк, но с управление рисками и штрафами за «зависание» в сделках

Рефакторинг/удаление старого кода с DQN и другими моделями

7. Задачи по очистке и рефакторингу кода
Удалить ненужные файлы и модули (список прописать отдельно)

Удалить код Tensorflow DQN, Kalman, XGBoost, несопутствующих индикаторов

Убрать зависимости, библиотеки, скрипты, которые больше не нужны

Написать задачи на очистку и проверку чистоты кода

8. Задачи по интеграции моделей
Создать новые скрипты или модули для обучения LSTM на паттернах и xLSTM на индикаторах

Создать общий модуль для объединения выводов обеих моделей и принятия консенсусного решения

Обеспечить логирование сделок, результатов, ошибок и ключевых метрик (например, PNL)

9. Поиск и сбор дополнительной информации с использованием MCP Thinking
Использовать MCP и MCP Tavily протоколы для глубокого поиска информации по перепроектированию, оптимизации архитектур LSTM/xLSTM, симуляции торгов крипто

Составить список вопросов и ответов, найденных в интернете, которые помогут лучшему пониманию проекта и его рисков

Включить эти выводы в раздел заметок и рекомендаций для дальнейшей доработки

10. Общие рекомендации для дальнейшей работы
Работать итеративно: сначала базовый прототип с LSTM (паттерны) и xLSTM (индикаторы), затем расширение до сложных симуляций и мета-решений

Документировать каждый этап, вести контроль качества кода и результатов

Планировать ресурсы для обучения xLSTM (GPU и время)

Включить задачи под «unit testing» и «integration testing» для всех ключевых модулей

Если хотите, могу оформить этот текст в файл и подготовить структурированный .md документ для выгрузки в VS Code, а также расписать задачи по каждому из пунктов с моментами контроля и тестирования. Просто дайте знать!