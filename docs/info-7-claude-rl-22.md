
–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ —è –≤–∏–∂—É:


"AttributeError: 'str' object has no attribute 'name'" –≤ regularization_callback.py: –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ. –û–Ω–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø–æ—Ç–æ–º—É, —á—Ç–æ self.model.optimizer.learning_rate –≤ –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å—Ç—Ä–æ–∫–æ–π, –∞ –Ω–µ —Ç–µ–Ω–∑–æ—Ä–æ–º –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –∫ –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å tf.keras.backend.set_value. –≠—Ç–æ —á–∞—Å—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ learning rate —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'auto') –∏–ª–∏ –µ—Å–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º.


–ü—Ä–æ–¥–æ–ª–∂–∞—é—â–∏–π—Å—è —Å–∏–ª—å–Ω—ã–π –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏/—Ç–µ—Å—Ç–µ:

"Confusion Matrix:" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç [0 0 0] –¥–ª—è BUY –∏ SELL, –∏ [ 399 35 64916] –¥–ª—è HOLD. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç HOLD –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ.
"–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π: BUY=0.6%, SELL=0.1%, HOLD=99.3%" –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —ç—Ç–æ: –º–æ–¥–µ–ª—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç BUY –∏–ª–∏ SELL.
–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –∫–ª–∞—Å—Å–æ–≤ —Å imblearn –¥–æ 12.5% BUY, 12.5% SELL, 75.0% HOLD –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–º –Ω–∞–±–æ—Ä–µ, –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –æ–Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ—á—Ç–∏ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ HOLD. –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –º–æ–¥–µ–ª—å –Ω–µ —Å–º–æ–≥–ª–∞ –Ω–∞—É—á–∏—Ç—å—Å—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å BUY/SELL —Å–∏–≥–Ω–∞–ª—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–º –Ω–∞–±–æ—Ä–µ.



"UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples." –≠—Ç–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤–æ–∑–Ω–∏–∫–∞—é—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–∏–Ω–Ω–æ–≥–æ –æ–±—Ä–∞–∑—Ü–∞ BUY –∏–ª–∏ SELL, –ª–∏–±–æ –º–æ–¥–µ–ª—å –≤–æ–æ–±—â–µ –Ω–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ö. –≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ —Å–º–µ—â–µ–Ω –≤ —Å—Ç–æ—Ä–æ–Ω—É HOLD, –∏–ª–∏ –∂–µ –º–æ–¥–µ–ª—å –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —ç—Ç–∏ –∫–ª–∞—Å—Å—ã.


"‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ —ç–ø–æ—Ö–µ 15! Val_loss/Train_loss = 1.38": –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –º–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–æ –ø–ª–æ—Ö–æ –æ–±–æ–±—â–∞–µ—Ç—Å—è –Ω–∞ –Ω–æ–≤—ã–µ, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è.


–ü–ª–∞–Ω –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:
–ü—Ä–æ–±–ª–µ–º—ã —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏ "AttributeError" —Ç–µ—Å–Ω–æ —Å–≤—è–∑–∞–Ω—ã —Å —Ç–µ–º, –∫–∞–∫ –º–æ–¥–µ–ª—å –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –∫–∞–∫ –æ–Ω–∞ –ø—ã—Ç–∞–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è. –ú—ã –¥–æ–ª–∂–Ω—ã:

–ò—Å–ø—Ä–∞–≤–∏—Ç—å "AttributeError": –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ learning_rate –≤—Å–µ–≥–¥–∞ —è–≤–ª—è–µ—Ç—Å—è –∏–∑–º–µ–Ω—è–µ–º—ã–º —Ç–µ–Ω–∑–æ—Ä–æ–º.
–£—Å–∏–ª–∏—Ç—å —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é BUY/SELL –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ: –ï—Å–ª–∏ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ—Ç BUY/SELL, –º–æ–¥–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –Ω–∞—É—á–∏—Ç—å—Å—è –∏—Ö —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å.
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å Focal Loss –∏ –≤–µ—Å–∞ –∫–ª–∞—Å—Å–æ–≤: –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –º–æ–¥–µ–ª—å –≤—Å–µ –µ—â–µ "–ª–µ–Ω–∏—Ç—Å—è" –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç HOLD.
–£–ª—É—á—à–∏—Ç—å —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è: –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–ª–±—ç–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.


–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:
–§–∞–π–ª 1: train_model.py
1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ AttributeError –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Learning Rate –≤ train_xlstm_rl_system
–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –í–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ train_xlstm_rl_system, –≥–¥–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å (—Å—Ç—Ä–æ–∫–∞ ~450).
–ó–ê–ú–ï–ù–ò–¢–¨:
# –°–¢–ê–†–´–ô –ö–û–î
optimizer = tf.keras.optimizers.Adam(
    learning_rate=0.0005,  # –£–º–µ–Ω—å—à–∞–µ–º LR —Å 0.001 –¥–æ 0.0005
    clipnorm=0.5,          # –£–º–µ–Ω—å—à–∞–µ–º clipnorm —Å 1.0 –¥–æ 0.5
    weight_decay=0.0001    # –î–æ–±–∞–≤–ª—è–µ–º weight decay
)
xlstm_model.model.compile(
    optimizer=optimizer,
    # –ò–ó–ú–ï–ù–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é Focal Loss
    loss=categorical_focal_loss(gamma=2.0, alpha=0.25), # <--- –ò–ó–ú–ï–ù–ï–ù–û
    metrics=[
        'accuracy',
        tf.keras.metrics.Precision(name='precision'),
        tf.keras.metrics.Recall(name='recall'),
        tf.keras.metrics.Precision(name='precision_0', class_id=0),
        tf.keras.metrics.Precision(name='precision_1', class_id=1),
        tf.keras.metrics.Precision(name='precision_2', class_id=2),
        tf.keras.metrics.Recall(name='recall_0', class_id=0),
        tf.keras.metrics.Recall(name='recall_1', class_id=1),
        tf.keras.metrics.Recall(name='recall_2', class_id=2),
    ]
)

–ù–ê –ù–û–í–´–ô –ö–û–î:
# –ù–û–í–´–ô –ö–û–î - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Learning Rate –∫–∞–∫ tf.Variable –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –∫–æ–ª–±—ç–∫–∞–º–∏
initial_learning_rate = tf.Variable(0.0005, dtype=tf.float32) # –ò–ó–ú–ï–ù–ï–ù–û: LR –∫–∞–∫ tf.Variable
optimizer = tf.keras.optimizers.Adam(
    learning_rate=initial_learning_rate, # –ò—Å–ø–æ–ª—å–∑—É–µ–º tf.Variable
    clipnorm=0.5,
    weight_decay=0.0001
)
xlstm_model.model.compile(
    optimizer=optimizer,
    # –ò–ó–ú–ï–ù–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é Focal Loss
    loss=categorical_focal_loss(gamma=1.0, alpha=0.3), # –ò–ó–ú–ï–ù–ï–ù–û: –ú–µ–Ω–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π Focal Loss
    metrics=[
        'accuracy',
        tf.keras.metrics.Precision(name='precision'),
        tf.keras.metrics.Recall(name='recall'),
        tf.keras.metrics.Precision(name='precision_0', class_id=0),
        tf.keras.metrics.Precision(name='precision_1', class_id=1),
        tf.keras.metrics.Precision(name='precision_2', class_id=2),
        tf.keras.metrics.Recall(name='recall_0', class_id=0),
        tf.keras.metrics.Recall(name='recall_1', class_id=1),
        tf.keras.metrics.Recall(name='recall_2', class_id=2),
    ]
)

–û–±—ä—è—Å–Ω–µ–Ω–∏–µ: –ü—Ä–æ–±–ª–µ–º–∞ AttributeError: 'str' object has no attribute 'name' –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ ReduceLROnPlateau –∏ AntiOverfittingCallback –ø—ã—Ç–∞—é—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å learning_rate –∏–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ –∫–∞–∫ —Ç–µ–Ω–∑–æ—Ä, –Ω–æ –æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ –æ–±—ã—á–Ω–æ–µ —á–∏—Å–ª–æ –∏–ª–∏ —Å—Ç—Ä–æ–∫–∞, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—à–∏–±–∫–µ. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è learning_rate –∫–∞–∫ tf.Variable –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —ç—Ç–æ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –∏–∑–º–µ–Ω—è–µ–º—ã–π —Ç–µ–Ω–∑–æ—Ä, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å –∫–æ–ª–±—ç–∫–∞–º–∏. –¢–∞–∫–∂–µ, —è –Ω–µ–º–Ω–æ–≥–æ –∏–∑–º–µ–Ω–∏–ª –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Focal Loss, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ –º–µ–Ω–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º.
2. –£–ª—É—á—à–µ–Ω–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤ –≤ prepare_xlstm_rl_data
–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –í–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ prepare_xlstm_rl_data, –≤ –±–ª–æ–∫–µ imblearn (—Å—Ç—Ä–æ–∫–∞ ~280).
–ó–ê–ú–ï–ù–ò–¢–¨:
# –°–¢–ê–†–´–ô –ö–û–î
# –¶–µ–ª–µ–≤–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: 10% BUY, 10% SELL, 80% HOLD (–±—ã–ª–æ 15/15/70)
total_samples = len(X)
target_buy_count = int(total_samples * 0.10) # <--- –ò–ó–ú–ï–ù–ï–ù–û —Å 0.15 –Ω–∞ 0.10
target_sell_count = int(total_samples * 0.10) # <--- –ò–ó–ú–ï–ù–ï–ù–û —Å 0.15 –Ω–∞ 0.10

current_buy_count = Counter(y_labels)[0]
current_sell_count = Counter(y_labels)[1]

sampling_strategy_smote = {
    0: max(current_buy_count, target_buy_count),
    1: max(current_sell_count, target_sell_count)
}

# ... (–ø—Ä–æ–ø—É—Å–∫ —á–∞—Å—Ç–∏ –∫–æ–¥–∞) ...

# Undersampling HOLD: –¶–µ–ª—å - —á—Ç–æ–±—ã HOLD –±—ã–ª –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ 3 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ, —á–µ–º —Å—É–º–º–∞ BUY + SELL
target_hold_count = min(current_hold_count_after_oversample, int((Counter(y_temp_labels)[0] + Counter(y_temp_labels)[1]) * 3.0)) # <--- –ò–ó–ú–ï–ù–ï–ù–û —Å 2.0 –Ω–∞ 3.0

undersampler = RandomUnderSampler(sampling_strategy={2: target_hold_count}, random_state=42)
X_resampled, y_resampled_labels = undersampler.fit_resample(X_temp, y_temp_labels)

–ù–ê –ù–û–í–´–ô –ö–û–î:
# –ù–û–í–´–ô –ö–û–î - –£–ª—É—á—à–µ–Ω–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –¥–ª—è –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–≥–æ oversampling BUY/SELL
# –¶–µ–ª–µ–≤–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: 20% BUY, 20% SELL, 60% HOLD (–±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π oversampling)
total_samples = len(X)
target_buy_count = int(total_samples * 0.20)  # –ò–ó–ú–ï–ù–ï–ù–û: —Å 0.10 –¥–æ 0.20
target_sell_count = int(total_samples * 0.20) # –ò–ó–ú–ï–ù–ï–ù–û: —Å 0.10 –¥–æ 0.20

current_buy_count = Counter(y_labels)[0]
current_sell_count = Counter(y_labels)[1]

sampling_strategy_smote = {
    0: max(current_buy_count, target_buy_count),
    1: max(current_sell_count, target_sell_count)
}

if current_buy_count > 0 or current_sell_count > 0:
    k_neighbors = min(5,
                      (current_buy_count - 1 if current_buy_count > 1 else 1),
                      (current_sell_count - 1 if current_sell_count > 1 else 1))
    k_neighbors = max(1, k_neighbors)

    if any(count <= k_neighbors for count in [current_buy_count, current_sell_count] if count > 0):
        print("‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—ç–º–ø–ª–æ–≤ –¥–ª—è SMOTE —Å k_neighbors, –∏—Å–ø–æ–ª—å–∑—É—é RandomOverSampler.")
        from imblearn.over_sampling import RandomOverSampler
        oversampler = RandomOverSampler(sampling_strategy=sampling_strategy_smote, random_state=42)
    else:
        oversampler = SMOTE(sampling_strategy=sampling_strategy_smote, random_state=42, k_neighbors=k_neighbors)

    X_temp, y_temp_labels = oversampler.fit_resample(X.reshape(len(X), -1), y_labels)
    print(f"–ë–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ –ø–æ—Å–ª–µ Oversampling: {Counter(y_temp_labels)} (BUY/SELL —É–≤–µ–ª–∏—á–µ–Ω—ã)")
else:
    X_temp, y_temp_labels = X.reshape(len(X), -1), y_labels
    print("–ü—Ä–æ–ø—É—Å—Ç–∏–ª Oversampling, —Ç–∞–∫ –∫–∞–∫ –Ω–µ—Ç BUY/SELL —Å–∏–≥–Ω–∞–ª–æ–≤.")

# Undersampling HOLD: –¶–µ–ª—å - —á—Ç–æ–±—ã HOLD –±—ã–ª –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ 1.5 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ, —á–µ–º —Å—É–º–º–∞ BUY + SELL
target_hold_count = min(current_hold_count_after_oversample, int((Counter(y_temp_labels)[0] + Counter(y_temp_labels)[1]) * 1.5)) # –ò–ó–ú–ï–ù–ï–ù–û: —Å 3.0 –¥–æ 1.5

undersampler = RandomUnderSampler(sampling_strategy={2: target_hold_count}, random_state=42)
X_resampled, y_resampled_labels = undersampler.fit_resample(X_temp, y_temp_labels)

–û–±—ä—è—Å–Ω–µ–Ω–∏–µ: –ú—ã –¥–µ–ª–∞–µ–º oversampling BUY/SELL –∫–ª–∞—Å—Å–æ–≤ –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º (–¥–æ 20% –∫–∞–∂–¥—ã–π), –∞ undersampling HOLD –º–µ–Ω–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º (HOLD –±—É–¥–µ—Ç –≤ 1.5 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ, —á–µ–º —Å—É–º–º–∞ BUY+SELL, –∞ –Ω–µ –≤ 3 —Ä–∞–∑–∞). –≠—Ç–æ –¥–æ–ª–∂–Ω–æ –ø–æ–º–æ—á—å –º–æ–¥–µ–ª–∏ –≤–∏–¥–µ—Ç—å –±–æ–ª—å—à–µ –ø—Ä–∏–º–µ—Ä–æ–≤ BUY/SELL –∏ —Å–Ω–∏–∑–∏—Ç—å –µ–µ —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç—å –∫ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—é —Ç–æ–ª—å–∫–æ HOLD.
3. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ Focal Loss –≤ train_model.py
–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ categorical_focal_loss (—Å—Ç—Ä–æ–∫–∞ ~50).
–ó–ê–ú–ï–ù–ò–¢–¨:
# –°–¢–ê–†–´–ô –ö–û–î
@tf.keras.utils.register_keras_serializable()
def categorical_focal_loss(gamma=1.5, alpha=0.25):  # –£–º–µ–Ω—å—à–∞–µ–º gamma, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º alpha
    """
    –ú–µ–Ω–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è Focal Loss
    gamma=1.5 - —É–º–µ—Ä–µ–Ω–Ω–∞—è —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö
    alpha=0.25 - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–µ—Å
    """
    def focal_loss_fixed(y_true, y_pred):
        epsilon = K.epsilon()
        y_pred = K.clip(y_pred, epsilon, 1. - epsilon)
        y_true = tf.cast(y_true, tf.float32)
        
        # –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –∫–ª–∞—Å—Å-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –≤–µ—Å–∞
        # –£–º–µ–Ω—å—à–∞–µ–º –≤–µ—Å–∞ BUY/SELL, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤–µ—Å HOLD
        class_weights = tf.constant([0.8, 0.8, 1.4])  # BUY, SELL, HOLD
        weights = tf.reduce_sum(class_weights * y_true, axis=-1, keepdims=True)
        
        cross_entropy = -y_true * K.log(y_pred)
        loss = alpha * K.pow(1 - y_pred, gamma) * cross_entropy * weights
        
        return K.sum(loss, axis=-1)
    
    return focal_loss_fixed

–ù–ê –ù–û–í–´–ô –ö–û–î:
# –ù–û–í–´–ô –ö–û–î - –ú–µ–Ω–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π Focal Loss –∏ –±–æ–ª–µ–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Å–∞
@tf.keras.utils.register_keras_serializable()
def categorical_focal_loss(gamma=1.0, alpha=0.3):  # –ò–ó–ú–ï–ù–ï–ù–û: gamma=1.0, alpha=0.3
    """
    –ú–µ–Ω–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è Focal Loss –¥–ª—è –ª—É—á—à–µ–π —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏,
    —Å –±–æ–ª–µ–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏ –∫–ª–∞—Å—Å–æ–≤.
    """
    def focal_loss_fixed(y_true, y_pred):
        epsilon = K.epsilon()
        y_pred = K.clip(y_pred, epsilon, 1. - epsilon)
        y_true = tf.cast(y_true, tf.float32)
        
        # –ò–ó–ú–ï–ù–ï–ù–ù–´–ï –∫–ª–∞—Å—Å-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –≤–µ—Å–∞: –±–æ–ª–µ–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã
        class_weights = tf.constant([1.2, 1.2, 0.8])  # –ò–ó–ú–ï–ù–ï–ù–û: BUY/SELL –Ω–µ–º–Ω–æ–≥–æ —É—Å–∏–ª–µ–Ω—ã, HOLD –Ω–µ–º–Ω–æ–≥–æ –æ—Å–ª–∞–±–ª–µ–Ω
        weights = tf.reduce_sum(class_weights * y_true, axis=-1, keepdims=True)
        
        cross_entropy = -y_true * K.log(y_pred)
        loss = alpha * K.pow(1 - y_pred, gamma) * cross_entropy * weights
        
        return K.sum(loss, axis=-1)
    
    return focal_loss_fixed

–û–±—ä—è—Å–Ω–µ–Ω–∏–µ: –ò–∑–º–µ–Ω–µ–Ω–∏–µ gamma –Ω–∞ 1.0 –¥–µ–ª–∞–µ—Ç Focal Loss –º–µ–Ω–µ–µ "—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º" –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö, —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—å—Å—è –Ω–∞ –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–æ–º —Å–ø–µ–∫—Ç—Ä–µ –¥–∞–Ω–Ω—ã—Ö. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ alpha –¥–æ 0.3 –¥–µ–ª–∞–µ—Ç –µ–≥–æ –Ω–µ–º–Ω–æ–≥–æ –±–æ–ª–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –∫ –æ—à–∏–±–∫–∞–º. –í–µ—Å–∞ –∫–ª–∞—Å—Å–æ–≤ –≤–Ω—É—Ç—Ä–∏ Focal Loss —Ç–∞–∫–∂–µ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã, —á—Ç–æ–±—ã –Ω–µ–º–Ω–æ–≥–æ —É—Å–∏–ª–∏—Ç—å BUY/SELL –∏ –æ—Å–ª–∞–±–∏—Ç—å HOLD.
4. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≤–µ—Å–æ–≤ –∫–ª–∞—Å—Å–æ–≤ –≤ train_xlstm_rl_system
–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –í–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ train_xlstm_rl_system, –≥–¥–µ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤–µ—Å–∞ –∫–ª–∞—Å—Å–æ–≤ (—Å—Ç—Ä–æ–∫–∞ ~350).
–ó–ê–ú–ï–ù–ò–¢–¨:
# –°–¢–ê–†–´–ô –ö–û–î
# –£–º–µ–Ω—å—à–∞–µ–º –≤–µ—Å–∞ BUY/SELL (–æ–Ω–∏ —Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ)
weight_reduction_factor = 0.6  # –£–º–µ–Ω—å—à–∞–µ–º –≤–µ—Å–∞ BUY/SELL
if 0 in class_weight_dict:
    class_weight_dict[0] *= weight_reduction_factor
if 1 in class_weight_dict:
    class_weight_dict[1] *= weight_reduction_factor

# –£–í–ï–õ–ò–ß–ò–í–ê–ï–ú –≤–µ—Å HOLD (—á—Ç–æ–±—ã –º–æ–¥–µ–ª—å —á–∞—â–µ –µ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–ª–∞)
hold_boost_factor = 1.8  # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤–µ—Å HOLD
if 2 in class_weight_dict:
    class_weight_dict[2] *= hold_boost_factor

–ù–ê –ù–û–í–´–ô –ö–û–î:
# –ù–û–í–´–ô –ö–û–î - –ë–æ–ª–µ–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Å–∞ –∫–ª–∞—Å—Å–æ–≤
# –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤–µ—Å–∞ BUY/SELL –Ω–µ–º–Ω–æ–≥–æ, —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å —É–¥–µ–ª—è–ª–∞ –∏–º –±–æ–ª—å—à–µ –≤–Ω–∏–º–∞–Ω–∏—è,
# –Ω–æ –Ω–µ –Ω–∞—Å—Ç–æ–ª—å–∫–æ, —á—Ç–æ–±—ã –æ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª–∞ HOLD.
# –£–º–µ–Ω—å—à–∞–µ–º –≤–µ—Å HOLD, –Ω–æ –Ω–µ —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–æ.
if 0 in class_weight_dict:
    class_weight_dict[0] *= 1.5  # –ò–ó–ú–ï–ù–ï–ù–û: –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤–µ—Å BUY
if 1 in class_weight_dict:
    class_weight_dict[1] *= 1.5  # –ò–ó–ú–ï–ù–ï–ù–û: –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤–µ—Å SELL

if 2 in class_weight_dict:
    class_weight_dict[2] *= 0.7  # –ò–ó–ú–ï–ù–ï–ù–û: –£–º–µ–Ω—å—à–∞–µ–º –≤–µ—Å HOLD

–û–±—ä—è—Å–Ω–µ–Ω–∏–µ: –ú—ã –µ—â–µ —Ä–∞–∑ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –≤–µ—Å–∞ –∫–ª–∞—Å—Å–æ–≤, —á—Ç–æ–±—ã –¥–∞—Ç—å BUY/SELL –Ω–µ–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ –≤–µ—Å–∞, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –≤–µ—Å –¥–ª—è HOLD. –≠—Ç–æ –¥–æ–ª–∂–Ω–æ –ø–æ–º–æ—á—å –º–æ–¥–µ–ª–∏ –Ω–∞—Ö–æ–¥–∏—Ç—å –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ–º –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤.
5. –£–ª—É—á—à–µ–Ω–Ω–∞—è TimeSeriesSplit –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (—á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ BUY/SELL)
–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –í–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ train_xlstm_rl_system, –≤ –±–ª–æ–∫–µ TimeSeriesSplit (—Å—Ç—Ä–æ–∫–∞ ~300).
–ó–ê–ú–ï–ù–ò–¢–¨:
# –°–¢–ê–†–´–ô –ö–û–î
# –°–Ω–∞—á–∞–ª–∞ –æ—Ç–¥–µ–ª–∏–º —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫—É (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 20% –¥–∞–Ω–Ω—ã—Ö)
test_size = int(len(X) * 0.2)
X_temp, X_test = X[:-test_size], X[-test_size:]
y_temp, y_test = y[:-test_size], y[-test_size:]

# –ó–∞—Ç–µ–º —Ä–∞–∑–¥–µ–ª–∏–º –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, 70/30)
# –ò—Å–ø–æ–ª—å–∑—É–µ–º TimeSeriesSplit –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π/–≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
# –°–æ–∑–¥–∞–µ–º 2 —Å–ø–ª–∏—Ç–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å 3 —á–∞—Å—Ç–∏: Train, Val, Test.
# –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–ø–ª–∏—Ç –±—É–¥–µ—Ç: Train_inner, Val_inner.
from sklearn.model_selection import TimeSeriesSplit
tscv_inner = TimeSeriesSplit(n_splits=2)

# –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
# –ó–¥–µ—Å—å –º—ã –±–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–ø–ª–∏—Ç, —á—Ç–æ–±—ã val_indices –±—ã–ª–∏ "–Ω–æ–≤–µ–µ" —á–µ–º train_indices
for train_idx, val_idx in tscv_inner.split(X_temp):
    pass # –ü—Ä–æ—Ö–æ–¥–∏–º –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–ø–ª–∏—Ç–∞

X_train, y_train = X_temp[train_idx], y_temp[train_idx]
X_val, y_val = X_temp[val_idx], y_temp[val_idx]

–ù–ê –ù–û–í–´–ô –ö–û–î:
# –ù–û–í–´–ô –ö–û–î - –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π TimeSeriesSplit –¥–ª—è –ª—É—á—à–µ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤
from sklearn.model_selection import StratifiedKFold # –ò–ó–ú–ï–ù–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º StratifiedKFold
from collections import Counter

print("\nüîÑ –ü—Ä–∏–º–µ–Ω—è—é –°–¢–†–ê–¢–ò–§–ò–¶–ò–†–û–í–ê–ù–ù–´–ô TimeSeriesSplit –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö...")

# –°–Ω–∞—á–∞–ª–∞ –æ—Ç–¥–µ–ª–∏–º —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫—É (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 20% –¥–∞–Ω–Ω—ã—Ö)
test_size = int(len(X) * 0.2)
X_temp, X_test = X[:-test_size], X[-test_size:]
y_temp, y_test = y[:-test_size], y[-test_size:]

# –î–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º StratifiedKFold,
# —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤ –≤ –∫–∞–∂–¥–æ–º —Å–ø–ª–∏—Ç–µ.
# –ú—ã –Ω–µ –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TimeSeriesSplit —Å–æ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –Ω–∞–ø—Ä—è–º—É—é,
# –ø–æ—ç—Ç–æ–º—É –∏–º–∏—Ç–∏—Ä—É–µ–º –µ–≥–æ, –±–µ—Ä—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏.
n_splits_stratified = 5 # –ò–ó–ú–ï–ù–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º 5 —Å–ø–ª–∏—Ç–æ–≤ –¥–ª—è –ª—É—á—à–µ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
skf = StratifiedKFold(n_splits=n_splits_stratified, shuffle=False) # shuffle=False –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞

train_indices_list = []
val_indices_list = []

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –º–µ—Ç–∫–∏ –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
y_temp_labels = np.argmax(y_temp, axis=1)

for train_idx, val_idx in skf.split(X_temp, y_temp_labels): # –ò–ó–ú–ï–ù–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º y_temp_labels –¥–ª—è —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    train_indices_list.append(train_idx)
    val_indices_list.append(val_idx)

# –ë–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–ø–ª–∏—Ç –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å "–≤—Ä–µ–º–µ–Ω–Ω–æ–π" –∞—Å–ø–µ–∫—Ç
X_train, y_train = X_temp[train_indices_list[-1]], y_temp[train_indices_list[-1]]
X_val, y_val = X_temp[val_indices_list[-1]], y_temp[val_indices_list[-1]]

print(f"‚úÖ –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π TimeSeriesSplit –∑–∞–≤–µ—Ä—à–µ–Ω.")
print(f"–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –≤ X_train: {Counter(np.argmax(y_train, axis=1))}")
print(f"–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –≤ X_val: {Counter(np.argmax(y_val, axis=1))}")
